<% @threads.each do |thread| %>
<% indent_level = -1 %>
<% thread.each do |comment| %>
  <% if comment.indent_level > indent_level %>
    <ol class="comments comments<%= comment.indent_level %>">
  <% elsif comment.indent_level < indent_level %>
    <% (indent_level - comment.indent_level).times do %>
      </ol>
    <% end %>
  <% end %>

  <%= render :partial => "comments/comment", :locals => {
    :comment => comment, :show_story => (comment.indent_level == 1) } %>

  <% indent_level = comment.indent_level %>
<% end %>
<% indent_level.times do %>
  </ol>
<% end %>
<% end %>
